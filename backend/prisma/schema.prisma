// prisma/schema.prisma

// Gerador do Prisma Client — usa o caminho padrão em node_modules/.prisma/client
generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

// =========================
//        MODELOS
// =========================

model Categoria {
  id          Int        @id @default(autoincrement())
  nome        String     @unique
  descricao   String?
  produtos    Produto[]
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model Produto {
  id            Int        @id @default(autoincrement())
  nome          String
  descricao     String?
  preco         Decimal     @db.Decimal(10, 2)
  estoque       Int         @default(0)
  categoriaId   Int
  categoria     Categoria   @relation(fields: [categoriaId], references: [id])
  itensPedido   ItemPedido[]
  createdAt     DateTime    @default(now())
  updatedAt     DateTime    @updatedAt
}

model Cliente {
  id          Int        @id @default(autoincrement())
  nome        String
  email       String     @unique
  telefone    String?
  pedidos     Pedido[]
  createdAt   DateTime   @default(now())
  updatedAt   DateTime   @updatedAt
}

model Pedido {
  id           Int           @id @default(autoincrement())
  clienteId    Int
  cliente      Cliente        @relation(fields: [clienteId], references: [id])
  itens        ItemPedido[]
  total        Decimal        @db.Decimal(10, 2)
  status       StatusPedido   @default(PENDENTE)
  criadoEm     DateTime       @default(now())
  atualizadoEm DateTime       @updatedAt
}

model ItemPedido {
  id         Int       @id @default(autoincrement())
  pedidoId   Int
  produtoId  Int
  quantidade Int        @default(1)
  subtotal   Decimal    @db.Decimal(10, 2)
  pedido     Pedido     @relation(fields: [pedidoId], references: [id])
  produto    Produto    @relation(fields: [produtoId], references: [id])
}

enum StatusPedido {
  PENDENTE
  EM_PREPARO
  CONCLUIDO
  CANCELADO
}
